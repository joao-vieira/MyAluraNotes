{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","e","importa","error","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b","negociacaoController","currentInstance"],"mappings":";;;;;;;;;;;;;;;AAAQA,mB,2BAAAA,gB;;AACAC,W,mBAAAA,Q;;AACAC,kB,yBAAAA,e;;AACAC,e,sBAAAA,Y;;AACAC,oB,8BAAAA,iB;;AACAC,a,sBAAAA,U;;AACAC,O,gBAAAA,I;;AACAC,a,qBAAAA,U;;;;;;;;;;;;;;;;;;;;;AAEFC,uB;AAEL,oCAAc;AAAA;;AACb,SAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;;AAEA,UAAKG,UAAL,GAAsBJ,EAAE,OAAF,CAAtB;AACA,UAAKK,gBAAL,GAAyBL,EAAE,aAAF,CAAzB;AACA,UAAKM,WAAL,GAAuBN,EAAE,QAAF,CAAvB;;AAEA,UAAKO,iBAAL,GAAyB,IAAIV,IAAJ,CACvB,IAAIN,gBAAJ,EADuB,EAEvB,IAAIE,eAAJ,CAAoBO,EAAE,kBAAF,CAApB,CAFuB,EAGvB,UAHuB,EAGX,SAHW,EAGA,QAHA,EAGU,cAHV,CAAzB;;AAMA,UAAKQ,SAAL,GAAiB,IAAIX,IAAJ,CAChB,IAAIL,QAAJ,EADgB,EAEhB,IAAIE,YAAJ,CAAiBM,EAAE,eAAF,CAAjB,CAFgB,EAGhB,OAHgB,CAAjB;;AAMA,UAAKS,WAAL,GAAmB,EAAnB,CAnBa,CAmBU;;AAEvB,UAAKC,QAAL,GAAgB,IAAIf,iBAAJ,EAAhB;;AAEA,UAAKgB,KAAL;AACA;;;;6BAGO;AAAA;;AAEP,WAAKD,QAAL,CACEE,KADF,GAEEC,IAFF,CAEO;AAAA,cACLC,YAAYC,OAAZ,CAAoB;AAAA,eACnB,MAAKR,iBAAL,CAAuBS,QAAvB,CAAgCC,UAAhC,CADmB;AAAA,QAApB,CADK;AAAA,OAFP,EAKEC,KALF,CAKQ;AAAA,cAAQ,MAAKV,SAAL,CAAeW,KAAf,GAAuBC,IAA/B;AAAA,OALR;;AAQAC,kBAAY,YAAM;AACjB,aAAKC,kBAAL;AACA,OAFD,EAEG,IAFH;AAGA;;;8BAGQC,K,EAAO;AAAA;;AAEfA,YAAMC,cAAN;;AAEA,UAAIP,aAAa,KAAKQ,eAAL,EAAjB;;AAEA,WAAKf,QAAL,CACEgB,QADF,CACWT,UADX,EAEEJ,IAFF,CAEO,oBAAY;AACjB,cAAKN,iBAAL,CAAuBS,QAAvB,CAAgCC,UAAhC;AACA,cAAKT,SAAL,CAAeW,KAAf,GAAuBQ,QAAvB;AACA,cAAKC,gBAAL;AACA,OANF,EAOEV,KAPF,CAOQ;AAAA,cAAQ,OAAKV,SAAL,CAAeW,KAAf,GAAuBU,CAA/B;AAAA,OAPR;AAQA;;;0CAGoB;AAAA;;AAEd,WAAKnB,QAAL,CACEoB,OADF,CACU,KAAKvB,iBAAL,CAAuBO,WADjC,EAEED,IAFF,CAEO,uBAAe;AACpBC,mBAAYC,OAAZ,CAAoB;AAAA,eAAc,OAAKR,iBAAL,CAAuBS,QAAvB,CAAgCC,UAAhC,CAAd;AAAA,QAApB;AACE,cAAKT,SAAL,CAAeW,KAAf,GAAuB,+CAAvB;AACF,OALF,EAMED,KANF,CAMQ;AAAA,cAAQ,OAAKV,SAAL,CAAeW,KAAf,GAAuBY,KAA/B;AAAA,OANR;AAOH;;;6BAGI;AAAA;;AAEP,WAAKrB,QAAL,CACQsB,KADR,GAEQnB,IAFR,CAEa,oBAAY;AACd,cAAKL,SAAL,CAAeW,KAAf,GAAuBQ,QAAvB;AACA,cAAKpB,iBAAL,CAAuB0B,OAAvB;AACH,OALR,EAMQf,KANR,CAMc;AAAA,cAAQ,OAAKV,SAAL,CAAeW,KAAf,GAAuBC,IAA/B;AAAA,OANd;AAOA;;;uCAGiB;AACjB,aAAO,IAAItB,UAAJ,CACNF,WAAWsC,aAAX,CAAyB,KAAK9B,UAAL,CAAgB+B,KAAzC,CADM,EAENC,SAAS,KAAK/B,gBAAL,CAAsB8B,KAA/B,CAFM,EAGNE,WAAW,KAAK/B,WAAL,CAAiB6B,KAA5B,CAHM,CAAP;AAKA;;;wCAGkB;AAClB,WAAK/B,UAAL,CAAgB+B,KAAhB,GAA0B,EAA1B;AACA,WAAK9B,gBAAL,CAAsB8B,KAAtB,GAA8B,CAA9B;AACA,WAAK7B,WAAL,CAAiB6B,KAAjB,GAA2B,GAA3B;;AAEA,WAAK/B,UAAL,CAAgBkC,KAAhB;AACA;;;4BAGMC,M,EAAQ;AACd,UAAG,KAAK9B,WAAL,IAAoB8B,MAAvB,EAA+B;AACrB,YAAKhC,iBAAL,CAAuBiC,YAAvB;AACH,OAFP,MAEa;AACH,YAAKjC,iBAAL,CAAuBkC,MAAvB,CAA8B,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUD,EAAEH,MAAF,IAAYI,EAAEJ,MAAF,CAAtB;AAAA,QAA9B;AACH;AACD,WAAK9B,WAAL,GAAmB8B,MAAnB;AACN;;;;;;AAMEK,uB,GAAuB,IAAI7C,oBAAJ,E;AAEpB,YAAS8C,eAAT,GAA2B;;AAEjC,WAAOD,oBAAP;AACA","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Mensagem} from '../models/Mensagem';\nimport {NegociacoesView} from '../views/NegociacoesView';\nimport {MensagemView} from '../views/MensagemView';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {DateHelper} from '../helpers/DateHelper';\nimport {Bind} from '../helpers/Bind';\nimport {Negociacao} from '../models/Negociacao';\n\nclass NegociacaoController {\n\n\tconstructor() {\n\t\tlet $ = document.querySelector.bind(document);\n\n\t\tthis._inputData \t   = $('#data');\n\t\tthis._inputQuantidade  = $('#quantidade');\n\t\tthis._inputValor \t   = $('#valor');\n\t\t\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\t\tnew ListaNegociacoes(), \n\t\t\t\tnew NegociacoesView($(\"#negociacoesView\")), \n\t\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n\t\t);\n\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(), \n\t\t\tnew MensagemView($('#mensagemView')), \n\t\t\t'texto'\n\t\t);\n\n\t\tthis._ordemAtual = ''; // quando a página for carregada, não tem critério. Só passa a ter quando ele começa a clicar nas colunas\t\t\n\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\t}\n\n\n\t_init() {\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes =>\n\t\t\t\tnegociacoes.forEach(negociacao =>\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\n\n\t\tsetInterval(() => {\n\t\t\tthis.importaNegociacoes();\n\t\t}, 3000);\n\t}\n\n\n\tadiciona(event) {\n\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = e);\n\t}\n\n\n\timportaNegociacoes() {\n\n        this._service\n        \t.importa(this._listaNegociacoes.negociacoes)\n        \t.then(negociacoes => {\n        \t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\n\t          \tthis._mensagem.texto = 'Negociações do período importadas com sucesso';\n        \t})\n        \t.catch(erro => this._mensagem.texto = error);  \n    }\n\n\n\tapaga() {\n\n\t\tthis._service\n\t        .apaga()\n\t        .then(mensagem => {\n\t            this._mensagem.texto = mensagem;\n\t            this._listaNegociacoes.esvazia();\n\t        })\n\t        .catch(erro => this._mensagem.texto = erro);\n\t}\n\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\n\t_limpaFormulario() {\n\t\tthis._inputData.value \t\t= '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value \t\t= 0.0;\n\t\t\n\t\tthis._inputData.focus();\n\t}\n\n\n\tordena(coluna) {\n\t\tif(this._ordemAtual == coluna) {\n            this._listaNegociacoes.inverteOrdem();\n        } else {\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n        }\n        this._ordemAtual = coluna;\n\t}\n\n}\n\n\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n\n\treturn negociacaoController;\n}"]}