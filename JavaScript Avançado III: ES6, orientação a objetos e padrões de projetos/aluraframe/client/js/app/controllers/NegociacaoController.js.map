{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_ordemAtual","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","e","importa","error","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Mensagem} from '../models/Mensagem';\nimport {NegociacoesView} from '../view/NegociacoesView';\nimport {MensagemView} from '../view/MensagemView';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {DateHelper} from '../helpers/DateHelper';\nimport {Bind} from '../helpers/Bind';\nimport {Negociacao} from '../models/Negociacao';\n\nclass NegociacaoController {\n\n\tconstructor() {\n\t\tlet $ = document.querySelector.bind(document);\n\n\t\tthis._inputData \t   = $('#data');\n\t\tthis._inputQuantidade  = $('#quantidade');\n\t\tthis._inputValor \t   = $('#valor');\n\t\t\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\t\tnew ListaNegociacoes(), \n\t\t\t\tnew NegociacoesView($(\"#negociacoesView\")), \n\t\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n\t\t);\n\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(), \n\t\t\tnew MensagemView($('#mensagemView')), \n\t\t\t'texto'\n\t\t);\n\n\t\tthis._ordemAtual = ''; // quando a página for carregada, não tem critério. Só passa a ter quando ele começa a clicar nas colunas\t\t\n\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\t}\n\n\n\t_init() {\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes =>\n\t\t\t\tnegociacoes.forEach(negociacao =>\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\n\n\t\tsetInterval(() => {\n\t\t\tthis.importaNegociacoes();\n\t\t}, 3000);\n\t}\n\n\n\tadiciona(event) {\n\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = e);\n\t}\n\n\n\timportaNegociacoes() {\n\n        this._service\n        \t.importa(this._listaNegociacoes.negociacoes)\n        \t.then(negociacoes => {\n        \t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\n\t          \tthis._mensagem.texto = 'Negociações do período importadas com sucesso';\n        \t})\n        \t.catch(erro => this._mensagem.texto = error);  \n    }\n\n\n\tapaga() {\n\n\t\tthis._service\n\t        .apaga()\n\t        .then(mensagem => {\n\t            this._mensagem.texto = mensagem;\n\t            this._listaNegociacoes.esvazia();\n\t        })\n\t        .catch(erro => this._mensagem.texto = erro);\n\t}\n\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\n\t_limpaFormulario() {\n\t\tthis._inputData.value \t\t= '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value \t\t= 0.0;\n\t\t\n\t\tthis._inputData.focus();\n\t}\n\n\n\tordena(coluna) {\n\t\tif(this._ordemAtual == coluna) {\n            this._listaNegociacoes.inverteOrdem();\n        } else {\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n        }\n        this._ordemAtual = coluna;\n\t}\n\n}"]}